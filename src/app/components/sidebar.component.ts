import { Component } from '@angular/core';
import { CommonModule } from '@angular/common';

interface NavigationItem {
  label: string;
  icon: string;
  active?: boolean;
  expanded?: boolean;
  hasSubmenu?: boolean;
  submenu?: NavigationItem[];
}

interface NavigationSection {
  title?: string;
  icon?: string;
  items: NavigationItem[];
}

@Component({
  selector: 'app-sidebar',
  standalone: true,
  imports: [CommonModule],
  template: `
    <div class="sidebar fixed right-0 top-0 h-full w-52 bg-gradient-to-b from-custom-gray to-black text-white flex flex-col z-50 font-cairo overflow-y-auto" dir="rtl">

      <div class="logo-section p-4 pt-5 border-b border-gray-700">
        <div class="logo flex justify-right mt-3 mb-3">
          <svg width="65" height="28" viewBox="0 0 90 35" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M29.6289 14.4207C29.8523 13.043 30.4033 11.9679 31.2595 11.2353C32.1679 10.4628 33.2997 10.0726 34.6325 10.0726C36.0471 10.0726 37.2236 10.4628 38.1171 11.2353C38.9659 11.9679 39.5243 13.043 39.7924 14.4207H29.6289ZM42.6441 12.4457C42.2271 11.3149 41.6315 10.3194 40.8794 9.49917C40.1274 8.68688 39.2116 8.04182 38.1543 7.58789C37.1045 7.14192 35.9131 6.91098 34.625 6.91098C33.3369 6.91098 32.22 7.14192 31.1925 7.58789C30.165 8.03385 29.2641 8.66299 28.5195 9.44343C27.7749 10.2239 27.1867 11.1636 26.7772 12.2307C26.3602 13.2979 26.1517 14.4446 26.1517 15.6471C26.1517 16.0294 26.1666 16.3639 26.1964 16.6426C26.2187 16.8258 26.2411 16.993 26.2709 17.1921C26.2858 17.2717 26.2932 17.3514 26.3081 17.423L26.3379 17.5664H39.8147C39.569 18.976 38.9435 20.1068 37.9533 20.943C36.9109 21.819 35.4738 22.265 33.6869 22.265C32.9348 22.265 32.2126 22.1774 31.535 22.0022L30.098 24.8293C31.1925 25.2274 32.3913 25.4186 33.6869 25.4186C35.1611 25.4186 36.5162 25.1876 37.6926 24.7257C38.884 24.2638 39.8966 23.6188 40.7156 22.7985C41.5347 21.9783 42.1676 20.9908 42.6069 19.8599C43.0462 18.7211 43.2621 17.4788 43.2621 16.1568C43.2621 14.8348 43.0536 13.5607 42.6441 12.4218" fill="white"/>
            <path d="M20.2079 1.72664V24.2081H23.3202V0.707291L20.2079 1.72664Z" fill="white"/>
            <path d="M17.0508 11.9521C17.0135 11.8406 16.9763 11.745 16.9316 11.6415L14.348 13.2104C14.5937 13.9828 14.7202 14.8509 14.7202 15.8065C14.7202 16.7622 14.5788 17.7019 14.2958 18.5221C14.0129 19.3504 13.6257 20.0512 13.1194 20.6325C12.6131 21.2139 11.9951 21.6598 11.2729 21.9863C10.5506 22.3049 9.7316 22.4642 8.82322 22.4642C7.91484 22.4642 7.11813 22.3049 6.38844 21.9863C5.65132 21.6678 5.03332 21.2139 4.52701 20.6325C4.0207 20.0512 3.62608 19.3504 3.35059 18.5221C3.06765 17.6939 2.93363 16.7861 2.93363 15.8065C2.93363 14.827 3.06019 13.9828 3.31335 13.2104L0.729669 11.6415C0.69244 11.745 0.64777 11.8486 0.617987 11.9601C0.201025 13.1387 0 14.4288 0 15.8065C0 17.1842 0.201025 18.4744 0.617987 19.653C1.0275 20.8396 1.62317 21.8589 2.39753 22.711C3.17189 23.5631 4.10261 24.2241 5.18969 24.7099C6.27677 25.1877 7.49042 25.4346 8.83065 25.4346C10.1709 25.4346 11.392 25.1957 12.4791 24.7099C13.5662 24.2321 14.4969 23.5631 15.2712 22.711C16.0456 21.8589 16.6413 20.8396 17.0582 19.653C17.4677 18.4664 17.6762 17.1842 17.6762 15.8065C17.6762 14.4288 17.4752 13.1387 17.0582 11.9601" fill="white"/>
            <path d="M7.11132 7.40391C7.20811 7.15704 7.34214 6.94999 7.50594 6.76682C7.66975 6.58366 7.86335 6.44031 8.09416 6.33678C8.32498 6.23326 8.56325 6.17751 8.82386 6.17751C9.08446 6.17751 9.32271 6.23326 9.55353 6.33678C9.7769 6.44031 9.97795 6.58366 10.1492 6.76682C10.3205 6.94999 10.4545 7.15704 10.5513 7.40391C10.648 7.65079 10.7002 7.90563 10.7002 8.18436C10.7002 8.46309 10.648 8.71793 10.5513 8.95684C10.4545 9.20371 10.3205 9.41077 10.1492 9.58597C9.97795 9.76117 9.78434 9.89655 9.55353 10.008C9.32271 10.1116 9.08446 10.1673 8.82386 10.1673C8.30265 10.1673 7.85589 9.97618 7.50594 9.59393C7.15599 9.21167 6.96985 8.74182 6.96985 8.18436C6.96985 7.90563 7.02198 7.65079 7.11877 7.40391" fill="white"/>
            <path d="M35.024 33.0015L34.6318 33.4155L35.0188 33.8349L35.411 33.421L35.024 33.0015Z" fill="white"/>
            <path d="M34.1008 32.9969L33.7086 33.4108L34.0956 33.8302L34.4878 33.4163L34.1008 32.9969Z" fill="white"/>
            <path d="M35.4657 30.2775L34.9891 30.4129C35.0338 30.5801 35.0636 30.7394 35.0859 30.9066C35.1082 31.0739 35.1157 31.2093 35.1157 31.3208C35.1157 31.5198 35.071 31.6791 34.9891 31.7986C34.9072 31.918 34.736 31.9738 34.4903 31.9738H21.4081C21.1847 31.9738 21.0283 31.918 20.9539 31.7986C20.8794 31.6871 20.8422 31.5119 20.8422 31.2889V28.3583H20.3656V32.2207C20.3656 32.5073 20.3284 32.7462 20.254 32.9294C20.1795 33.1126 20.0678 33.248 19.9189 33.3356C19.77 33.4232 19.5839 33.463 19.3605 33.463C19.1222 33.463 18.9286 33.4232 18.7797 33.3435C18.6308 33.2639 18.5265 33.1444 18.4595 32.9931C18.3925 32.8418 18.3553 32.6587 18.3553 32.4436C18.3553 32.2605 18.3702 32.0773 18.4074 31.8782C18.4446 31.6871 18.4894 31.4959 18.5415 31.3128L18.0947 31.1217C18.0277 31.3367 17.9681 31.5517 17.9309 31.7747C17.8937 31.9977 17.8713 32.2127 17.8713 32.4277C17.8713 32.7383 17.9235 33.017 18.0277 33.2559C18.132 33.4948 18.2883 33.678 18.5117 33.8134C18.7276 33.9488 19.0105 34.0125 19.3605 34.0125C19.5988 34.0125 19.8147 33.9806 20.0008 33.9089C20.187 33.8373 20.3433 33.7338 20.4624 33.5904C20.589 33.4471 20.6784 33.2718 20.7454 33.0568C20.8124 32.8418 20.8422 32.5949 20.8422 32.3082C20.8943 32.364 20.9464 32.4038 20.9911 32.4436C21.0358 32.4755 21.0953 32.4994 21.1549 32.5153C21.2145 32.5312 21.2889 32.5392 21.3857 32.5392H21.4155H34.4977C34.7955 32.5392 35.0189 32.4834 35.1753 32.3799C35.3316 32.2684 35.4433 32.1251 35.5029 31.9419C35.5624 31.7508 35.5922 31.5437 35.5922 31.3048C35.5922 31.1615 35.5848 30.9942 35.5625 30.8111C35.5476 30.6279 35.5103 30.4607 35.4657 30.3014" fill="white"/>
            <path d="M40.618 31.9494C40.551 32.0291 40.4467 32.0609 40.3053 32.0609C40.2531 32.0609 40.1936 32.0529 40.1266 32.029C40.0596 32.0052 39.9925 31.9653 39.9106 31.9176C39.851 31.8777 39.7915 31.83 39.7319 31.7822C39.6724 31.7344 39.6053 31.6707 39.5458 31.599C39.5979 31.4875 39.65 31.376 39.7096 31.2725C39.7692 31.169 39.8436 31.0814 39.9181 31.0177C39.9925 30.954 40.0819 30.9141 40.1712 30.9141C40.3425 30.9141 40.4765 30.9778 40.5733 31.1132C40.6701 31.2486 40.7148 31.4159 40.7148 31.6229C40.7148 31.7663 40.685 31.8777 40.6105 31.9574M37.1631 31.9892C36.9621 31.9892 36.8207 31.9574 36.7313 31.8937C36.642 31.83 36.5973 31.7344 36.5973 31.5911C36.5973 31.5035 36.6122 31.3999 36.6345 31.2805C36.6643 31.169 36.709 31.0655 36.776 30.9779C36.843 30.8903 36.9398 30.8504 37.0589 30.8504C37.1483 30.8504 37.2302 30.8743 37.2972 30.9221C37.3642 30.9699 37.4238 31.0416 37.4759 31.1292C37.528 31.2247 37.5652 31.3442 37.595 31.4796C37.6248 31.6229 37.6471 31.7901 37.6546 31.9813H37.1557L37.1631 31.9892ZM43.0453 30.293L42.5688 30.4284C42.6134 30.5956 42.6432 30.7549 42.6656 30.9221C42.6879 31.0893 42.6954 31.2247 42.6954 31.3362C42.6954 31.5353 42.6507 31.6946 42.5688 31.814C42.4869 31.9335 42.3156 31.9892 42.0699 31.9892H41.6753C41.5934 31.9892 41.5189 31.9653 41.4519 31.9176C41.3849 31.8698 41.3253 31.8061 41.2807 31.7105C41.2285 31.6229 41.1913 31.5114 41.1689 31.376C41.1317 31.1849 41.0722 31.0177 40.9903 30.8664C40.9084 30.715 40.7967 30.5956 40.6626 30.508C40.5286 30.4204 40.3574 30.3726 40.1638 30.3726C39.9925 30.3726 39.8511 30.4124 39.7319 30.4841C39.6128 30.5638 39.516 30.6593 39.4341 30.7788C39.3522 30.8982 39.2777 31.0336 39.2107 31.169C39.1437 31.3044 39.0767 31.4318 39.0097 31.5592C38.9427 31.6786 38.8682 31.7822 38.7789 31.8538C38.697 31.9335 38.5853 31.9733 38.4661 31.9733H38.1311C38.1311 31.7026 38.1013 31.4636 38.0492 31.2566C37.9971 31.0495 37.9301 30.8743 37.8333 30.731C37.7439 30.5876 37.6322 30.4841 37.5057 30.4045C37.3791 30.3328 37.2376 30.293 37.0887 30.293C36.9398 30.293 36.7983 30.3328 36.6792 30.4045C36.5601 30.4841 36.4632 30.5797 36.3813 30.7071C36.2994 30.8345 36.2399 30.9699 36.2026 31.1292C36.1654 31.2805 36.1431 31.4397 36.1431 31.5911C36.1431 31.9016 36.2324 32.1246 36.4111 32.2839C36.5898 32.4352 36.8504 32.5148 37.2078 32.5148H37.6471C37.6024 32.7139 37.5205 32.8812 37.3939 33.0325C37.2674 33.1838 37.1036 33.3032 36.9025 33.4068C36.7015 33.5103 36.4558 33.5899 36.1803 33.6457L36.3441 34.1235C36.7387 34.0439 37.0589 33.9164 37.3046 33.7492C37.5429 33.582 37.729 33.3988 37.8482 33.1838C37.9673 32.9688 38.0492 32.7458 38.0938 32.5148H38.4885C38.6225 32.5148 38.7417 32.4989 38.831 32.4591C38.9204 32.4272 39.0097 32.3715 39.0841 32.3078C39.1586 32.2441 39.2331 32.1565 39.315 32.0609C39.4267 32.1724 39.5383 32.2759 39.6426 32.3476C39.7468 32.4272 39.8585 32.483 39.9702 32.5228C40.0819 32.5626 40.1936 32.5785 40.3202 32.5785C40.5063 32.5785 40.6552 32.5387 40.7743 32.4671C40.8935 32.3954 40.9903 32.2998 41.0647 32.1724C41.1392 32.2839 41.2285 32.3715 41.3402 32.4272C41.4445 32.475 41.5487 32.4989 41.6529 32.4989H41.6902H42.0923C42.3901 32.4989 42.6134 32.4432 42.7698 32.3396C42.9262 32.2282 43.0379 32.0848 43.0974 31.9016C43.157 31.7105 43.1868 31.5035 43.1868 31.2645C43.1868 31.1212 43.1793 30.954 43.157 30.7708C43.1421 30.5876 43.1049 30.4204 43.0602 30.2611" fill="white"/>
            <path d="M42.8901 28.9927L42.5016 29.4106L42.8923 29.8261L43.2808 29.4082L42.8901 28.9927Z" fill="white"/>
            <path d="M41.963 28.9974L41.5745 29.4153L41.9651 29.8308L42.3537 29.4129L41.963 28.9974Z" fill="white"/>
            <path d="M59.72 33.457C60.2382 33.6666 60.9842 33.9246 61.8872 34.1423C61.4396 34.1987 60.9842 34.2309 60.5288 34.2309C53.0611 34.2309 46.999 26.5641 46.999 17.1155C46.999 7.6669 53.0533 0 60.5288 0C60.9842 0 61.4396 0.0322482 61.8872 0.0886817C60.9921 0.306354 60.2539 0.56434 59.7357 0.77395C59.7357 0.77395 59.72 0.773946 59.7121 0.782008C59.6807 0.79007 59.6571 0.8062 59.6336 0.814262C59.5551 0.84651 59.4844 0.878754 59.4059 0.911002C59.3352 0.943249 59.2645 0.975493 59.1938 1.00774C59.0682 1.06417 58.9818 1.10449 58.9347 1.12868C53.8385 3.5795 50.2185 9.81943 50.2185 17.1235C50.2185 24.4276 53.9327 30.8207 59.131 33.2071C59.2724 33.2716 59.4608 33.3602 59.7121 33.457" fill="#FED109"/>
            <path d="M63.8556 32.2642C63.1175 32.5464 62.3558 32.7398 61.5705 32.8366C56.7727 30.2084 53.4119 24.162 53.4119 17.1239C53.4119 10.0858 56.7727 4.03133 61.5784 1.40314C62.3636 1.50795 63.1253 1.70144 63.8634 1.97554C59.5682 4.84559 56.6392 10.5454 56.6392 17.1158C56.6392 23.6863 59.5682 29.3861 63.8634 32.2561" fill="#EBA921"/>
            <path d="M67.5956 29.9103C67.0145 30.4424 66.4098 30.91 65.7738 31.305C62.1852 28.2254 59.8217 23.0254 59.8217 17.1241C59.8217 11.2228 62.1852 6.02283 65.7738 2.94317C66.402 3.33821 67.0066 3.80579 67.5877 4.33788C64.8001 7.47397 63.049 12.037 63.049 17.1241C63.049 22.2112 64.8001 26.7742 67.5877 29.9103" fill="#B6862D"/>
            <path d="M68.4863 34.1183C69.0124 34.1989 69.5542 34.2473 70.0961 34.2473C77.5637 34.2473 83.6258 26.5804 83.6258 17.1318C83.6258 7.68322 77.5716 0.0163345 70.0961 0.0163345C69.5464 0.0163345 69.0124 0.064709 68.4863 0.145328C75.1923 1.15307 80.3985 8.37655 80.3985 17.1318C80.3985 25.8871 75.1923 33.1105 68.4863 34.1183Z" fill="#EBA921"/>
            <path d="M64.4927 33.457C63.9744 33.6666 63.2285 33.9246 62.3254 34.1423C62.773 34.1987 63.2285 34.2309 63.6839 34.2309C71.1516 34.2309 77.2136 26.5641 77.2136 17.1155C77.2136 7.6669 71.1594 0 63.6839 0C63.2285 0 62.773 0.0322482 62.3254 0.0886817C63.2206 0.306354 63.9587 0.56434 64.477 0.77395C64.477 0.77395 64.4927 0.773946 64.5006 0.782008C64.532 0.79007 64.5555 0.8062 64.5791 0.814262C64.6576 0.84651 64.7283 0.878754 64.8068 0.911002C64.8775 0.943249 64.9481 0.975493 65.0188 1.00774C65.1445 1.06417 65.2308 1.10449 65.2779 1.12868C70.3742 3.5795 73.9941 9.81943 73.9941 17.1235C73.9941 24.4276 70.2799 30.8207 65.0816 33.2071C64.9403 33.2716 64.7518 33.3602 64.5006 33.457" fill="#FED109"/>
            <path d="M86.3969 21.3069C85.0541 28.095 80.4997 33.2708 74.8931 34.1173C75.4192 34.1979 75.961 34.2463 76.5028 34.2463C82.8319 34.2463 88.148 28.74 89.6242 21.3149H86.3969V21.3069Z" fill="#B6862D"/>
            <path d="M90.0003 15.9465H85.3124C85.2575 14.9146 85.1318 13.9149 84.9355 12.9394H86.3882C85.0454 6.15125 80.4832 0.975496 74.8844 0.128994C75.4105 0.0483745 75.9523 0 76.4941 0C77.5699 0 78.6379 0.161248 79.6665 0.475663C81.0564 0.894883 82.3521 1.59626 83.5142 2.48307C84.7235 3.41826 85.7757 4.55499 86.6552 5.82071C87.5896 7.16705 88.3278 8.65045 88.8696 10.2064C89.5135 12.0445 89.8825 13.9955 89.9846 15.9465" fill="#B6862D"/>
          </svg>
        </div>
      </div>

      <nav class="nav-menu flex-1 py-2">
        <div *ngFor="let section of navigationSections; let isLast = last" class="section" [class.border-b-0]="isLast">
          <div *ngIf="section.title" class="section-title px-3 py-1.5 font-medium text-white text-right flex items-center gap-1.5" style="font-size: 10px;">
            <i [class]="section.icon" class="text-white" style="font-size: 9px;" *ngIf="section.icon"></i>
            <span>{{ section.title }}</span>
          </div>
          
          <div class="section-items" [class.pb-2]="!isLast" [class.border-b]="!isLast" [class.border-gray-700]="!isLast">
            <div *ngFor="let item of section.items" class="px-2 py-0.5">
              <a 
                href="#" 
                class="nav-item flex items-center py-1.5 px-2 text-gray-400 transition-all rounded-md hover:bg-white/10 hover:text-white gap-1.5"
                style="font-size: 11px;"
                [class.active]="item.active"
                [class.expanded]="item.expanded"
                (click)="toggleSubmenu(item, $event)"
              >
                <i [class]="item.icon" class="text-gray-400 hover:text-white transition-colors" style="font-size: 9px;" *ngIf="item.icon"></i>
                <span>{{ item.label }}</span>
              </a>
              
              <div *ngIf="item.hasSubmenu && item.expanded" class="sub-nav mt-1 mr-3">
                <a 
                  *ngFor="let subItem of item.submenu"
                  href="#" 
                  class="sub-nav-item flex items-center gap-1.5 py-1 px-2 text-gray-400 transition-all rounded-md hover:text-white hover:bg-white/10"
                  style="font-size: 10px;"
                  [class.active]="subItem.active"
                >
                  <i [class]="subItem.icon" class="text-gray-400 hover:text-white transition-colors" style="font-size: 8px;" *ngIf="subItem.icon"></i>
                  <span>{{ subItem.label }}</span>
                </a>
              </div>
            </div>
          </div>
        </div>
      </nav>

      <div class="footer-section border-t border-gray-700 p-2">
        <div class="flex items-center justify-between p-1.5 bg-black rounded-md">
          <div class="user-info flex items-center gap-1">
            <div class="user-avatar w-4 h-4 bg-gray-600 rounded-full flex items-center justify-center">
              <i class="fas fa-user text-white" style="font-size: 6px;"></i>
            </div>
            <div>
              <div class="font-medium text-white" style="font-size: 8px;">أحمد إبراهيم</div>
              <div class="text-gray-400 bg-gray-700 px-1 py-0.5 rounded text-center" style="font-size: 6px;">Manager</div>
            </div>
          </div>
              <button class="logout-btn flex items-center gap-1 py-1 px-1 text-gray-300 transition-all rounded-md hover:text-white hover:bg-white/10" style="font-size: 7px;">
              <span>تسجيل الخروج</span>
           <i class="fas fa-sign-out-alt text-gray-400" style="font-size: 6px; transform: scaleX(-1);"></i>
            </button>
        </div>
      </div>
    </div>
  `,
  styles: [`
    .nav-item.active {
      @apply bg-white text-gray-800 font-medium;
    }
    
    .nav-item.active i {
      @apply text-gray-800 !important;
    }
    
    .nav-item.expanded {
      @apply bg-white/5;
    }
    
    .sub-nav-item.active {
      @apply bg-white text-gray-800 font-medium;
    }
    
    .sub-nav-item.active i {
      @apply text-gray-800 !important;
    }
    
    .section {
      margin-bottom: 1rem;
    }
    
    .section:last-child {
      margin-bottom: 0;
    }
  `]
})
export class SidebarComponent {
  navigationSections: NavigationSection[] = [
    {
      title: 'الرئيسية',
      items: [
        { 
          label: 'الرئيسية', 
          icon: 'fas fa-home'
        },
        { 
          label: 'العملاء', 
          icon: 'fas fa-users'
        },
        { 
          label: 'التمويلات', 
          icon: 'fas fa-coins'
        },
        { 
          label: 'حساب التمويل', 
          icon: 'fas fa-calculator'
        }
      ]
    },
    {
      title: 'شركات البيع المعتمدة',
      items: [
        { 
          label: 'المنشآت', 
          icon: 'fas fa-building',
          active: true
        },
        { 
          label: 'الأفراد', 
          icon: 'fas fa-user'
        }
      ]
    },
    {
      title: 'الإعدادات',
      items: [
        { 
          label: 'الإشعارات', 
          icon: 'fas fa-bell'
        },
        { 
          label: 'فريق الدعم', 
          icon: 'fas fa-headset'
        },
        { 
          label: 'الإعدادات', 
          icon: 'fas fa-cog'
        }
      ]
    }
  ];

  toggleSubmenu(item: NavigationItem, event: Event): void {
    event.preventDefault();
    if (item.hasSubmenu) {
      item.expanded = !item.expanded;
    }
  }
}
